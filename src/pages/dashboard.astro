---
import Layout from '../layouts/Layout.astro';
import RelatedPapers from '../components/dashboard/RelatedPapers.astro';
import StatisticsCard from '../components/dashboard/StatisticsCard.astro';
import ChartSection from '../components/dashboard/ChartSection.astro';
import { TopicAnalysisChart } from '../components/dashboard/TopicAnalysisChart';
import { TemporalAnalysisChart } from '../components/dashboard/TemporalAnalysisChart';
import {
  generateTemporalData,
  DASHBOARD_STATS,
  TOPIC_COLORS
} from '../lib/utils';
import type { Topic, Paper } from '../types/dashboard';

// Centralized topic data
const topics: Topic[] = [
  { id: 'topic1', name: 'Machine Learning', count: 150, keywords: [['neural networks', 45], ['deep learning', 38]] },
  { id: 'topic2', name: 'Computer Vision', count: 120, keywords: [['image processing', 42], ['object detection', 35]] },
  { id: 'topic3', name: 'Natural Language', count: 95, keywords: [['language models', 40], ['text analysis', 33]] },
  { id: 'topic4', name: 'Robotics', count: 80, keywords: [['autonomous systems', 35], ['control', 28]] },
  { id: 'topic5', name: 'Data Science', count: 110, keywords: [['statistics', 38], ['visualization', 30]] },
  { id: 'topic6', name: 'Artificial Intelligence', count: 200, keywords: [['ai systems', 50], ['intelligence', 45]] },
];

// Generate temporal data from topics
const temporalData = generateTemporalData(topics);

// Related papers data
const relatedPapers: Paper[] = [
  {
    id: 'paper1',
    title: 'Deep Learning Approaches for Natural Language Processing',
    authors: ['John Smith', 'Jane Doe'],
    year: 2023,
    citations: 245,
    abstract: 'This paper presents novel deep learning techniques for improving natural language processing tasks...',
    topics: ['Deep Learning', 'NLP']
  },
  {
    id: 'paper2',
    title: 'Computer Version Applications in Autonomous Vehicles',
    authors: ['Alice Brown', 'Charlie Wilson'],
    year: 2023,
    citations: 185,
    abstract: 'We explore the application of computer vision algorithms in autonomous vehicle systems...',
    topics: ['Computer Vision', 'Autonomous Systems']
  },
  {
    id: 'paper3',
    title: 'Reinforcement Learning for Game AI',
    authors: ['David Lee', 'Emma Davis'],
    year: 2022,
    citations: 156,
    abstract: 'This research investigates reinforcement learning methods for creating intelligent game AI...',
    topics: ['Reinforcement Learning', 'Game AI']
  }
];
---


<Layout title="Dashboard - PaperTrends Research Analysis" canonical="/dashboard">
  <main class="page-layout">
    <!-- Header Section -->
    <section class="section-header">
      <div class="container-main">
        <!-- Page Header -->
        <div class="py-4">
          <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
            <!-- Title Section -->
            <div class="flex items-center space-x-3">
              <div class="w-6 h-6 bg-gray-900 dark:bg-white rounded-md flex items-center justify-center">
                <svg class="w-3 h-3 text-white dark:text-gray-900" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                </svg>
              </div>
              <div>
                <h1 class="text-lg font-medium text-gray-900 dark:text-white tracking-tight">
                  Dashboard
                </h1>
                <p class="text-xs text-gray-500 dark:text-gray-400 font-normal">
                  Research analytics
                </p>
              </div>
            </div>
            
            <!-- Statistics Cards -->
            <div class="grid grid-cols-2 sm:flex sm:flex-wrap sm:items-center gap-3 sm:gap-4">
              {DASHBOARD_STATS.map((stat) => (
                <StatisticsCard stats={stat} />
              ))}
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Main Content Layout -->
    <div class="container-main section">
      <div class="w-full">
        <div class="space-y-6">
          <!-- Chart Sections Row -->
          <div class="grid grid-cols-1 lg:grid-cols-5 gap-6">
            <!-- Topic Analysis Section -->
            <ChartSection
              title="Topic Analysis"
              description="Explore research topic relationships and clustering patterns"
              topics={topics}
              colors={TOPIC_COLORS}
              chartType="pack"
              gridSpan="lg:col-span-2"
            >
              <TopicAnalysisChart data={topics} client:load />
            </ChartSection>
            
            <!-- Temporal Analysis Section -->
            <ChartSection
              title="Temporal Analysis"
              description="Track research evolution and emerging trends over time"
              topics={topics}
              colors={TOPIC_COLORS}
              chartType="area"
            >
              <TemporalAnalysisChart data={temporalData} client:load />
            </ChartSection>
          </div>

          <!-- Papers Section -->
          <div class="w-full">
            <div class="card card-padding">
              <div class="mb-4">
                <h3 class="heading-tertiary">
                  Representative Papers
                </h3>
                <p class="text-meta">
                  Recent papers in AI Systems & Human Intelligence
                </p>
              </div>
              <RelatedPapers papers={relatedPapers} />
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</Layout>