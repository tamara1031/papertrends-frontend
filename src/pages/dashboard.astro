---
import Layout from '../layouts/Layout.astro';
import { RelatedPapers } from '../components/dashboard';
import { TopicAnalysisChart } from '../components/dashboard/TopicAnalysisChart';
import { TemporalAnalysisChart } from '../components/dashboard/TemporalAnalysisChart';

// Mock data for dashboard demonstration
const mockTopicData = [
  { id: 'topic1', name: 'Machine Learning', count: 150, keywords: [['neural networks', 45], ['deep learning', 38], ['algorithms', 32]] },
  { id: 'topic2', name: 'Computer Vision', count: 120, keywords: [['image processing', 42], ['object detection', 35], ['recognition', 28]] },
  { id: 'topic3', name: 'Natural Language', count: 95, keywords: [['language models', 40], ['text analysis', 33], ['nlp', 25]] },
  { id: 'topic4', name: 'Robotics', count: 80, keywords: [['autonomous systems', 35], ['control', 28], ['navigation', 22]] },
  { id: 'topic5', name: 'Data Science', count: 110, keywords: [['statistics', 38], ['visualization', 30], ['analytics', 25]] },
  { id: 'topic6', name: 'Artificial Intelligence', count: 200, keywords: [['ai systems', 50], ['intelligence', 45], ['automation', 40]] },
];

const mockAnalysisData = {
  topics: {
    data: {
      topic1: { name: 'Machine Learning', keywords: [['neural networks', 45], ['deep learning', 38]], count: 150 },
      topic2: { name: 'Computer Vision', keywords: [['image processing', 42], ['object detection', 35]], count: 120 },
      topic3: { name: 'Natural Language', keywords: [['language models', 40], ['text analysis', 33]], count: 95 },
      topic4: { name: 'Robotics', keywords: [['autonomous systems', 35], ['control', 28]], count: 80 },
      topic5: { name: 'Data Science', keywords: [['statistics', 38], ['visualization', 30]], count: 110 },
      topic6: { name: 'Artificial Intelligence', keywords: [['ai systems', 50], ['intelligence', 45]], count: 200 },
    },
    correlations: [
      [1, 0.8, 0.6, 0.4, 0.7, 0.9], 
      [0.8, 1, 0.5, 0.3, 0.6, 0.7], 
      [0.6, 0.5, 1, 0.2, 0.8, 0.6], 
      [0.4, 0.3, 0.2, 1, 0.3, 0.4], 
      [0.7, 0.6, 0.8, 0.3, 1, 0.8], 
      [0.9, 0.7, 0.6, 0.4, 0.8, 1]
    ],
    series: {
      '2020': [10, 8, 6, 4, 7, 12],
      '2021': [15, 12, 9, 6, 10, 18],
      '2022': [20, 16, 12, 8, 13, 24],
      '2023': [25, 20, 15, 10, 16, 30],
      '2024': [30, 24, 18, 12, 19, 36],
    },
    papers: {}
  },
  metadata: {
    categoryId: 'dashboard',
    subcategoryId: 'overview',
    lastUpdated: '2024-01-01',
    dataVersion: '1.0.0',
    period: { start: '2020-01-01', end: '2024-12-31' }
  }
};


// Mock data for related papers
const mockRelatedPapers = [
  {
    id: 'paper1',
    title: 'Deep Learning Approaches for Natural Language Processing',
    authors: ['John Smith', 'Jane Doe', 'Bob Johnson'],
    year: 2023,
    citations: 245,
    abstract: 'This paper presents novel deep learning techniques for improving natural language processing tasks...',
    topics: ['Deep Learning', 'NLP', 'Machine Learning']
  },
  {
    id: 'paper2',
    title: 'Computer Vision Applications in Autonomous Vehicles',
    authors: ['Alice Brown', 'Charlie Wilson'],
    year: 2023,
    citations: 189,
    abstract: 'We explore the application of computer vision algorithms in autonomous vehicle systems...',
    topics: ['Computer Vision', 'Autonomous Systems', 'Robotics']
  },
  {
    id: 'paper3',
    title: 'Reinforcement Learning for Game AI',
    authors: ['David Lee', 'Emma Davis', 'Frank Miller'],
    year: 2022,
    citations: 156,
    abstract: 'This research investigates reinforcement learning methods for creating intelligent game AI...',
    topics: ['Reinforcement Learning', 'Game AI', 'Machine Learning']
  },
  {
    id: 'paper4',
    title: 'Data Science Methodologies for Big Data Analytics',
    authors: ['Grace Taylor', 'Henry Anderson'],
    year: 2023,
    citations: 134,
    abstract: 'We present comprehensive methodologies for analyzing large-scale datasets using data science techniques...',
    topics: ['Data Science', 'Big Data', 'Analytics']
  }
];
---

<Layout title="Dashboard - PaperTrends Research Analysis" canonical="/dashboard">
  <main class="min-h-screen bg-gray-50 dark:bg-gray-900">
    <!-- Header Section -->
    <section class="bg-white dark:bg-gray-900 border-b border-gray-100 dark:border-gray-800">
      <div class="max-w-[90%] mx-auto px-6 sm:px-8 lg:px-12">
        <!-- Page Header -->
        <div class="py-3">
          <div class="flex items-center justify-between">
            <div class="flex items-center space-x-3">
              <div class="w-6 h-6 bg-gray-900 dark:bg-white rounded-md flex items-center justify-center">
                <svg class="w-3 h-3 text-white dark:text-gray-900" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                </svg>
              </div>
              <div>
                <h1 class="text-lg font-medium text-gray-900 dark:text-white tracking-tight">
                  Dashboard
                </h1>
                <p class="text-xs text-gray-500 dark:text-gray-400 font-normal">
                  Research analytics
                </p>
              </div>
            </div>
            
            <!-- Statistics Cards -->
            <div class="hidden lg:flex items-center space-x-6">
              <div class="group bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-3 min-w-[100px] h-[70px] flex flex-col justify-between cursor-pointer">
                <div class="flex items-center space-x-2">
                  <div class="w-2 h-2 bg-red-500 rounded-full"></div>
                  <span class="text-xs text-gray-600 dark:text-gray-400 font-medium">Papers</span>
                </div>
                <div class="text-lg font-semibold text-gray-900 dark:text-white">88,303</div>
                <div class="text-xs text-red-500 opacity-0 group-hover:opacity-100 transition-opacity duration-300">+12.5%</div>
              </div>
              
              <div class="group bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-3 min-w-[100px] h-[70px] flex flex-col justify-between cursor-pointer">
                <div class="flex items-center space-x-2">
                  <div class="w-2 h-2 bg-orange-500 rounded-full"></div>
                  <span class="text-xs text-gray-600 dark:text-gray-400 font-medium">Topics</span>
                </div>
                <div class="text-lg font-semibold text-gray-900 dark:text-white">48</div>
                <div class="text-xs text-orange-500 opacity-0 group-hover:opacity-100 transition-opacity duration-300">+3 new</div>
              </div>
              
              <div class="group bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-3 min-w-[120px] h-[70px] flex flex-col justify-between cursor-pointer">
                <div class="flex items-center space-x-2">
                  <div class="w-2 h-2 bg-yellow-500 rounded-full"></div>
                  <span class="text-xs text-gray-600 dark:text-gray-400 font-medium">Period</span>
                </div>
                <div class="text-sm font-semibold text-gray-900 dark:text-white">2020-2025</div>
                <div class="text-xs text-gray-500 dark:text-gray-400">69mo</div>
              </div>
              
              <div class="group bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-3 min-w-[100px] h-[70px] flex flex-col justify-between cursor-pointer">
                <div class="flex items-center space-x-2">
                  <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                  <span class="text-xs text-gray-600 dark:text-gray-400 font-medium">Updated</span>
                </div>
                <div class="text-sm font-semibold text-gray-900 dark:text-white">Sep 26</div>
                <div class="text-xs text-gray-500 dark:text-gray-400">v0.0.2</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Main Content Layout -->
    <div class="max-w-[90%] mx-auto px-6 sm:px-8 lg:px-12 py-6">
      <!-- Main Content -->
      <div class="w-full">
          <div class="space-y-6">
            <!-- First Row: Topic Analysis (Left 2/5) and Temporal Analysis (Right 3/5) -->
            <div class="grid grid-cols-1 lg:grid-cols-5 gap-6">
              <!-- Left Column: Topic Analysis (2/5) -->
              <div class="lg:col-span-2">
                <div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 h-full">
                  <div class="mb-4">
                    <div class="flex items-center justify-between mb-3">
                      <div class="flex items-center space-x-3">
                        <div class="w-6 h-6 bg-gray-900 dark:bg-white rounded-md flex items-center justify-center">
                          <svg class="w-3 h-3 text-white dark:text-gray-900" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
                          </svg>
                        </div>
                        <h2 class="text-lg font-medium text-gray-900 dark:text-white">
                          Topic Analysis
                        </h2>
                      </div>
                      
                      <!-- Chart Type Toggle -->
                      <div class="flex bg-gray-100 dark:bg-gray-700 rounded-md p-0.5">
                        <button 
                          id="bubble-btn"
                          class="px-3 py-1 text-xs bg-gray-900 dark:bg-white text-white dark:text-gray-900 rounded-sm font-medium"
                        >
                          Bubble
                        </button>
                        <button 
                          id="treemap-btn"
                          class="px-3 py-1 text-xs text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"
                        >
                          Treemap
                        </button>
                      </div>
                    </div>
                    <p class="text-sm text-gray-600 dark:text-gray-400">
                      Explore research topic relationships and clustering patterns
                    </p>
                  </div>
                  
                  <!-- D3 Chart Container - Responsive -->
                  <div class="w-full h-96 lg:h-[500px]">
                    <TopicAnalysisChart 
                      data={mockTopicData} 
                      client:load 
                    />
                  </div>
                </div>
              </div>

              <!-- Right Column: Temporal Analysis (3/5) -->
              <div class="lg:col-span-3">
                <div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 h-full">
                  <div class="mb-4">
                    <div class="flex items-center space-x-3 mb-3">
                      <div class="w-6 h-6 bg-gray-900 dark:bg-white rounded-md flex items-center justify-center">
                        <svg class="w-3 h-3 text-white dark:text-gray-900" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                        </svg>
                      </div>
                      <h2 class="text-lg font-medium text-gray-900 dark:text-white">
                        Temporal Analysis
                      </h2>
                    </div>
                    <p class="text-sm text-gray-600 dark:text-gray-400">
                      Track research evolution and emerging trends over time
                    </p>
                  </div>
                  
                  <!-- D3 Chart Container -->
                  <div class="w-full h-96 lg:h-[500px]">
                    <TemporalAnalysisChart 
                      data={mockAnalysisData} 
                      client:load 
                    />
                  </div>
                </div>
              </div>
            </div>

            <!-- Second Row: Representative Papers (Full Width) -->
            <div class="w-full">
              <div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6">
                <div class="mb-4">
                  <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                      <div class="w-6 h-6 bg-gray-900 dark:bg-white rounded-md flex items-center justify-center">
                        <svg class="w-3 h-3 text-white dark:text-gray-900" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                      </div>
                      <h3 class="text-lg font-medium text-gray-900 dark:text-white">
                        Representative Papers
                      </h3>
                    </div>
                    <div class="flex items-center space-x-3">
                      <span class="text-sm text-gray-600 dark:text-gray-400">Topic: AI Systems & Human Intelligence</span>
                      <button class="px-3 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600">
                        Clear Filter
                      </button>
                    </div>
                  </div>
                </div>
                <RelatedPapers papers={mockRelatedPapers} />
              </div>
            </div>
          </div>
      </div>
    </div>
  </main>
</Layout>
